# Разработка

## Ветки
- Временно вся разработка в ветке school, с периодическими мержами в master. 
Важно не коммитить папки build/lib чтоб не делать ненужных конфликтов.
- Сборки собираются из master.

## Обновления
- Синхронизация БД лежит вне приложения и должна быть выполнена отдельно.
  - Триггер выполнения синхронизации для main.js: файл dbversion - если
  значение в нем меньше захардкоженного - выполняется dbsync и перезаписывается версия
- Система может работать на сервере или запускаться из сборки. Проверка обновлений 
не привязана к режиму запуска.
  - выполненные обновления с датой выполнения хранятся в файле updatelog, путь к которому
  задается через env.updatelog
  - каждое обновление представляет собой обычный код в async функции
  - сервер в afterInit читает файл, выполняет обновления и обновляет файл
- Сборка в main подменяет путь к updatelog на тот же файл рядом с файлом БД.
- Стартовая БД остается неизменной: при первоначальном запуске на нее накатываются все обновления.
- Резервный вариант (не реализован): Стартовая БД должна включать все обновления. При этом создается updatelog с полным
списком обновлений. Если целевой файл БД отсутствует, значит вместе с файлом БД копируется
и полный файл "сделанных" обновлений (в стартовой) и dbversion.   
  
## Модули
- Сборка читает файл с модулями из файла modules рядом с файлом БД. 
